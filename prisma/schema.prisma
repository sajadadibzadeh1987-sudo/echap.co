generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/* ---------------- ENUM Ù‡Ø§ ---------------- */

enum JobAdStatus {
  PENDING
  PUBLISHED
  REJECTED
}

enum UserRole {
  USER
  FREELANCER
  SUPPLIER
  PRINTSHOP
  SUPER_ADMIN
}

enum ChatSender {
  USER
  SYSTEM
  ADMIN
}

enum NotificationType {
  AD_CREATED
  AD_PENDING
  AD_APPROVED
  AD_REJECTED
  AD_DELETED
}

/**
 * Ú¯Ø±ÙˆÙ‡ Ú©Ù„ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ â€“ Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§
 */
enum CategoryGroup {
  MACHINERY      // ÙØ±ÙˆØ´ Ù…Ø§Ø´ÛŒÙ†â€ŒØ¢Ù„Ø§Øª Ùˆ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ú†Ø§Ù¾/ØµØ­Ø§ÙÛŒ/Ø¨Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ/Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ùˆ...
  SUPPLIER       // ØªØ£Ù…ÛŒÙ†â€ŒÚ©Ù†Ù†Ø¯Ù‡: Ú©Ø§ØºØ°ØŒ Ù…Ù‚ÙˆØ§ØŒ Ù…Ø±Ú©Ø¨ØŒ Ù…ÙˆØ§Ø¯ØŒ Ù‚Ø·Ø¹Ø§Øª Ùˆ...
  PRINT_SERVICE  // Ø®Ø¯Ù…Ø§Øª Ú†Ø§Ù¾: Ø§ÙØ³ØªØŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ØŒ Ø±ÙˆÙ„ØŒ Ù…ØªØ§Ù„Ø§ÛŒØ²ØŒ Ø³ÛŒÙ„Ú©ØŒ ØªØ§Ù…Ù¾ÙˆØŒ ÙÙ„Øªâ€ŒØ¨Ø¯ Ùˆ...
  SERVICE        // Ø®Ø¯Ù…Ø§Øª ØªÚ©Ù…ÛŒÙ„ÛŒ: Ø¯Ø§ÛŒÚ©Ø§ØªØŒ Ø³Ù„ÙÙˆÙ†ØŒ ÛŒÙˆÙˆÛŒØŒ Ù‡Ø§Øª ÙÙˆÛŒÙ„ØŒ Ø¬Ø¹Ø¨Ù‡ Ú†Ø³Ø¨Ø§Ù†ÛŒØŒ ØµØ­Ø§ÙÛŒ Ùˆ...
  FREELANCER     // ÙØ±ÛŒÙ„Ù†Ø³Ø±Ù‡Ø§ Ùˆ Ø²Ù…ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„ÛŒØªâ€ŒØ´Ø§Ù†
  EMPLOYMENT     // Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… (Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†ÛŒØ±Ùˆ)
  READY_TO_WORK  // Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ù‡ Ú©Ø§Ø± (Ø±Ø²ÙˆÙ…Ù‡â€ŒÛŒ Ø§ÙØ±Ø§Ø¯)
  OTHER          // Ø³Ø§ÛŒØ±
}

/**
 * Ù†ÙˆØ¹ Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ®Ø¯Ø§Ù…ÛŒ
 */
enum EmploymentType {
  FULL_TIME
  PART_TIME
  PROJECT
  REMOTE
}

/* ---------------- Ù…Ø¯Ù„â€ŒÙ‡Ø§ ---------------- */

model User {
  id               String            @id @default(cuid())
  email            String?           @unique
  password         String?
  createdAt        DateTime          @default(now())
  bio              String?
  phone            String            @unique
  updatedAt        DateTime          @updatedAt
  otp              String?
  otpExpiry        DateTime?
  firstName        String?
  image            String?
  lastName         String?
  hasSelectedRole  Boolean           @default(false)
  slug             String?           @unique
  coins            Int               @default(0)
  lastCheckIn      DateTime?
  role             UserRole          @default(USER)

  businessProfile  BusinessProfile?
  printShopProfile PrintShopProfile?

  chatMessages     ChatMessage[]
  jobAds           JobAd[]
  notifications    Notification[]
}

model JobAd {
  id             String         @id @default(cuid())
  title          String
  description    String

  /// Ø¹Ù†ÙˆØ§Ù† Ø¯Ø³ØªÙ‡ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ù…ØªÙ†ÛŒ (Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø³Ø±ÛŒØ¹)
  category       String

  createdAt      DateTime       @default(now())
  userId         String?
  phone          String

  /// Ù…Ø³ÛŒØ± Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ (Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¨Ø§ Ú©Ø¯Ù‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ)
  images         String[]
  isFeatured     Boolean        @default(false)
  status         JobAdStatus    @default(PENDING)

  categorySlug   String?
  group          String?

  deleteReason   String?
  deletedAt      DateTime?
  deletedById    String?
  isDeleted      Boolean        @default(false)
  moderatedAt    DateTime?
  moderatedById  String?
  moderationNote String?

  /// ğŸ”¹ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… / Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ¨Ù‡â€ŒÚ©Ø§Ø±
  employmentType EmploymentType?
  /// Ù…ÛŒØ²Ø§Ù† Ø­Ù‚ÙˆÙ‚ ÛŒØ§ Ø¨Ø§Ø²Ù‡ (Ø¨Ù‡â€ŒØµÙˆØ±Øª Ù…ØªÙ† Ø¢Ø²Ø§Ø¯Ø› Ù…Ø«Ù„Ø§Ù‹ Â«Û²Û° ØªØ§ Û³Û° Ù…ÛŒÙ„ÛŒÙˆÙ†Â»)
  salary         String?

  /// âœ… Ø³Ø§Ø®ØªØ§Ø± Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù ØªØµÙˆÛŒØ±
  /// Ù‡Ø± Ø¢ÛŒØªÙ… Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø´Ø¨ÛŒÙ‡ Ø§ÛŒÙ† Ø¨Ø§Ø´Ø¯:
  /// { "full": "/uploads/abc.jpg", "thumb": "/uploads/thumbs/abc.jpg" }
  imagesJson     Json[]         @default([])

  /// ğŸ”— Ø§Ø±ØªØ¨Ø§Ø·â€ŒÙ‡Ø§
  user           User?          @relation(fields: [userId], references: [id])
  chatMessages   ChatMessage[]
  notifications  Notification[]

  /// ğŸ”— Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Category (Ø³Ù…Øª Ù…Ù‚Ø§Ø¨Ù„ Category.jobAds)
  categoryId     Int?
  categoryRef    Category?      @relation("CategoryJobAds", fields: [categoryId], references: [id])
}

model BusinessProfile {
  id            String   @id @default(cuid())
  userId        String   @unique
  slug          String   @unique
  displayName   String
  description   String?
  services      String[]
  phone         String?
  address       String?
  locationLat   Float?
  locationLng   Float?
  galleryImages String[]
  openingHours  String?
  website       String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  logoUrl       String?

  user          User     @relation(fields: [userId], references: [id])
}

model PrintShopProfile {
  id            String   @id @default(cuid())
  userId        String   @unique
  name          String
  slug          String   @unique
  logoUrl       String?
  address       String?
  phone         String?
  website       String?
  galleryImages String[]
  clients       String[]
  capabilities  String[] @default([])
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  description   String?
  locationLat   Float?
  locationLng   Float?
  openingHours  String?

  user          User     @relation(fields: [userId], references: [id])
}

model OTP {
  id        Int      @id @default(autoincrement())
  phone     String   @unique
  code      String
  createdAt DateTime @default(now())
}

model ChatMessage {
  id        String     @id @default(cuid())
  userId    String
  sender    ChatSender
  text      String
  jobAdId   String?
  isRead    Boolean    @default(false)
  createdAt DateTime   @default(now())
  readAt    DateTime?

  jobAd     JobAd?     @relation(fields: [jobAdId], references: [id])
  user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Notification {
  id        String           @id @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  jobAdId   String?
  sender    String           @default("Ø§ÛŒÚ†Ø§Ù¾")
  isRead    Boolean          @default(false)
  createdAt DateTime         @default(now())
  readAt    DateTime?

  jobAd     JobAd?           @relation(fields: [jobAdId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)
}

/**
 * âœ… Ù…Ø¯Ù„ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ (Ù…Ø«Ù„ Ø¯ÛŒÙˆØ§Ø±)
 */
model Category {
  id        Int        @id @default(autoincrement())

  /// Ø¯Ø³ØªÙ‡â€ŒÛŒ ÙˆØ§Ù„Ø¯ (Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª Ø¯Ø±Ø®Øª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ)
  parentId  Int?
  parent    Category?  @relation("CategoryToParent", fields: [parentId], references: [id])
  children  Category[] @relation("CategoryToParent")

  /// slug ÛŒÚ©ØªØ§ Ø¨Ø±Ø§ÛŒ URL Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± ÙØ±Ù…â€ŒÙ‡Ø§
  slug      String     @unique

  /// Ø¹Ù†ÙˆØ§Ù† ÙØ§Ø±Ø³ÛŒ Ú©Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØ¨ÛŒÙ†Ø¯
  titleFa   String

  /// Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ Ú†Ù†Ø¯Ø²Ø¨Ø§Ù†Ù‡
  titleEn   String?

  /// Ú¯Ø±ÙˆÙ‡ Ú©Ù„ÛŒ â€“ Ø¨Ø± Ø§Ø³Ø§Ø³ CategoryGroup
  group     CategoryGroup

  /// ØªØ±ØªÛŒØ¨ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§
  sortOrder Int        @default(0)

  /// ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯Ù† Ø¯Ø³ØªÙ‡
  isActive  Boolean    @default(true)

  /// Ø¨Ø±Ø§ÛŒ Ø¢ÛŒÚ©ÙˆÙ†ØŒ ØªÚ¯ Ùˆ ...
  iconKey   String?

  /// Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ù‡ Ø§ÛŒÙ† Ø¯Ø³ØªÙ‡ ÙˆØµÙ„ Ù‡Ø³ØªÙ†Ø¯
  jobAds    JobAd[]    @relation("CategoryJobAds")
}
