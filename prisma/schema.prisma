generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String    @id @default(cuid())
  phone           String    @unique
  password        String?
  role            String    @default("user")
  hasSelectedRole Boolean   @default(false)
  firstName       String?
  lastName        String?
  email           String?   @unique
  slug            String?   @unique
  image           String?
  bio             String?
  otp             String?
  otpExpiry       DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  jobAds           JobAd[]
  businessProfile  BusinessProfile?
  printShopProfile PrintShopProfile?
}

model JobAd {
  id          String   @id @default(cuid())
  title       String
  description String
  category    String
  phone       String
  createdAt   DateTime @default(now())
  isFeatured  Boolean  @default(false)
  images      String[]

  // وضعیت آگهی (صف انتشار، منتشر شده، رد شده)
  status JobAdStatus @default(PENDING)

  userId String?
  user   User?   @relation(fields: [userId], references: [id])
}

model BusinessProfile {
  id     String @id @default(cuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id])

  slug          String   @unique
  displayName   String
  description   String?
  services      String[]
  phone         String?
  address       String?
  locationLat   Float?
  locationLng   Float?
  logoUrl       String?
  galleryImages String[]
  openingHours  String?
  website       String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model PrintShopProfile {
  id     String @id @default(cuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id])

  name          String
  slug          String   @unique
  description   String?
  phone         String?
  address       String?
  locationLat   Float?
  locationLng   Float?
  logoUrl       String?
  galleryImages String[]
  clients       String[]
  capabilities  String[] @default([])
  openingHours  String?
  website       String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model OTP {
  id        Int      @id @default(autoincrement())
  phone     String   @unique
  code      String
  createdAt DateTime @default(now())
}

enum JobAdStatus {
  PENDING
  PUBLISHED
  REJECTED
}
